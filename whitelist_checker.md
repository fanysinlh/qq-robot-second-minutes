# 🔍 QQ机器人IP白名单问题排查清单

## 当前状态
- **公网IP**: `165.232.174.245`
- **错误信息**: "接口访问源IP不在白名单"
- **AppID**: `102808275`

## 📋 详细检查步骤

### 1. 登录QQ开放平台
- [ ] 访问 https://q.qq.com/
- [ ] 使用正确的QQ账号登录（创建机器人的账号）

### 2. 找到你的机器人应用
- [ ] 在"我的应用"中找到AppID为 `102808275` 的应用
- [ ] 确认应用状态（应该是"开发中"、"审核中"或"已上线"）

### 3. 检查环境设置
QQ机器人有两个环境，需要分别检查：

#### 沙盒环境 (Sandbox)
- [ ] 点击"沙盒环境"标签
- [ ] 进入"开发设置" -> "服务器配置"
- [ ] 检查"IP白名单"设置
- [ ] 确认 `165.232.174.245` 在沙盒环境的白名单中

#### 正式环境 (Production)
- [ ] 点击"正式环境"标签  
- [ ] 进入"开发设置" -> "服务器配置"
- [ ] 检查"IP白名单"设置
- [ ] 确认 `165.232.174.245` 在正式环境的白名单中

### 4. 检查机器人权限
- [ ] 确认机器人已申请必要的权限
- [ ] 检查"消息权限"是否已开启
- [ ] 确认没有被限制或封禁

### 5. 等待生效
- [ ] 白名单设置后等待 **15-30分钟** 
- [ ] 有些情况下可能需要等待更长时间

### 6. 测试不同API端点
机器人可能使用不同的API端点：
- `api.sgroup.qq.com` (正式环境)
- `sandbox.api.sgroup.qq.com` (沙盒环境)

## 🛠️ 可能的解决方案

### 方案A: 确保两个环境都设置白名单
很多开发者只在一个环境中设置了白名单，建议：
1. **沙盒环境和正式环境都添加IP白名单**
2. 确保设置完全相同

### 方案B: 检查机器人状态
1. 确认机器人应用状态正常
2. 如果是"审核中"，可能需要等待审核通过
3. 如果是"已下线"，需要重新上线

### 方案C: 重新生成凭证
1. 如果长时间无法解决，尝试重新生成Secret
2. 更新配置文件中的Secret
3. 重新设置白名单

### 方案D: 联系技术支持
如果以上方法都无效：
1. 联系QQ开放平台技术支持
2. 提供详细信息：AppID、IP地址、错误信息
3. 技术支持邮箱: q_developer@tencent.com

## 📞 紧急联系方式
- **QQ开放平台官方群**: 搜索"QQ开放平台"
- **技术支持邮箱**: q_developer@tencent.com
- **官方文档**: https://bot.q.qq.com/wiki/

## 💡 临时解决方案
如果白名单问题持续存在，可以考虑：
1. **使用云服务器** - 获得固定IP
2. **使用内网穿透** - 如frp、ngrok等
3. **等待官方修复** - 有时是平台问题

---

## ✅ 完成检查后
请在完成每项检查后打勾 ☑️，这样可以确保不遗漏任何步骤。

**最重要的是确保沙盒环境和正式环境的白名单都正确设置！**
